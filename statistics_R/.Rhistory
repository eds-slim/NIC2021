scale_y_continuous("Somatosensory deficit [193-RASP]") +
scale_shape_manual(name = "Phase", values = c(13, 1, 2, 4)) +
scale_color_manual(name = "Phase", values = c(swatch()[2],'darkred'), labels = c("Acute", "Chronic")) +
guides(color = FALSE, group=FALSE, shape=FALSE) + # time = guide_legend(title = "Phase", )
theme(
legend.position = c(.2, .8),
panel.grid.minor = element_blank()
)
p.vol
ggsave("./../../derivatives/figures/statsplots/vol_RASP.png"
, plot = p.vol
, units = "cm", width = 8, height = 8)
scientific_10()
scientific_10
scientific_10(x = 0.1)
p.vol <- d.plot.vol %>%
unnest(c(pris, data), names_repair = "unique") %>%
filter(mod == 'RASP' & time == 'T1') %>%
bind_cols(gdata::read.xls('./../../clinical/MRdate_lesionsites.xlsx', sheet = 1) %>%
as_tibble() %>%
dplyr::select(Probanden.ID, `diff.mri.onset.`, `X.4`) %>%
dplyr::filter(!is.na(Probanden.ID))
) %>%
mutate(compartment = as.character(X.4)
, compartment = case_when(stringr::str_starts(compartment, 'comb') ~ 'combined'
, compartment %in% c('brain stem', 'cerebellar') ~ 'hind brain'
, TRUE ~ compartment)) %>%
ggplot(aes(x = lesionvolume/1000, y = value, group = time)) +
geom_point(aes(shape = compartment, color = if_else(`subID...3` %in% highInf, 'red', 'blue')), alpha = .5, size = 1) +
geom_line(aes(y = curve.vol), d.curve.vol %>% filter(mod == 'RASP' & time == 'T1')) +
geom_errorbar(aes(ymin = lwr, ymax = upr), alpha = .25) +
geom_point(aes(y = pest), fill = "white", shape = 21, size = .25) +
theme_minimal() +
#facet_grid(~mod) +
scale_x_continuous("Lesion volume [ml]", trans = "log10", breaks = c(0.1, 1, 10, 100, 1000), labels = expression(10^-01)) +
scale_y_continuous("Somatosensory deficit [193-RASP]") +
scale_shape_manual(name = "Phase", values = c(13, 1, 2, 4)) +
scale_color_manual(name = "Phase", values = c(swatch()[2],'darkred'), labels = c("Acute", "Chronic")) +
guides(color = FALSE, group=FALSE, shape=FALSE) + # time = guide_legend(title = "Phase", )
theme(
legend.position = c(.2, .8),
panel.grid.minor = element_blank()
)
p.vol
p.vol <- d.plot.vol %>%
unnest(c(pris, data), names_repair = "unique") %>%
filter(mod == 'RASP' & time == 'T1') %>%
bind_cols(gdata::read.xls('./../../clinical/MRdate_lesionsites.xlsx', sheet = 1) %>%
as_tibble() %>%
dplyr::select(Probanden.ID, `diff.mri.onset.`, `X.4`) %>%
dplyr::filter(!is.na(Probanden.ID))
) %>%
mutate(compartment = as.character(X.4)
, compartment = case_when(stringr::str_starts(compartment, 'comb') ~ 'combined'
, compartment %in% c('brain stem', 'cerebellar') ~ 'hind brain'
, TRUE ~ compartment)) %>%
ggplot(aes(x = lesionvolume/1000, y = value, group = time)) +
geom_point(aes(shape = compartment, color = if_else(`subID...3` %in% highInf, 'red', 'blue')), alpha = .5, size = 1) +
geom_line(aes(y = curve.vol), d.curve.vol %>% filter(mod == 'RASP' & time == 'T1')) +
geom_errorbar(aes(ymin = lwr, ymax = upr), alpha = .25) +
geom_point(aes(y = pest), fill = "white", shape = 21, size = .25) +
theme_minimal() +
#facet_grid(~mod) +
scale_x_continuous("Lesion volume [ml]", trans = "log10", breaks = c(0.1, 1, 10, 100, 1000), labels = rep(expression(10^-01),5)) +
scale_y_continuous("Somatosensory deficit [193-RASP]") +
scale_shape_manual(name = "Phase", values = c(13, 1, 2, 4)) +
scale_color_manual(name = "Phase", values = c(swatch()[2],'darkred'), labels = c("Acute", "Chronic")) +
guides(color = FALSE, group=FALSE, shape=FALSE) + # time = guide_legend(title = "Phase", )
theme(
legend.position = c(.2, .8),
panel.grid.minor = element_blank()
)
p.vol
p.vol <- d.plot.vol %>%
unnest(c(pris, data), names_repair = "unique") %>%
filter(mod == 'RASP' & time == 'T1') %>%
bind_cols(gdata::read.xls('./../../clinical/MRdate_lesionsites.xlsx', sheet = 1) %>%
as_tibble() %>%
dplyr::select(Probanden.ID, `diff.mri.onset.`, `X.4`) %>%
dplyr::filter(!is.na(Probanden.ID))
) %>%
mutate(compartment = as.character(X.4)
, compartment = case_when(stringr::str_starts(compartment, 'comb') ~ 'combined'
, compartment %in% c('brain stem', 'cerebellar') ~ 'hind brain'
, TRUE ~ compartment)) %>%
ggplot(aes(x = lesionvolume/1000, y = value, group = time)) +
geom_point(aes(shape = compartment, color = if_else(`subID...3` %in% highInf, 'red', 'blue')), alpha = .5, size = 1) +
geom_line(aes(y = curve.vol), d.curve.vol %>% filter(mod == 'RASP' & time == 'T1')) +
geom_errorbar(aes(ymin = lwr, ymax = upr), alpha = .25) +
geom_point(aes(y = pest), fill = "white", shape = 21, size = .25) +
theme_minimal() +
#facet_grid(~mod) +
scale_x_continuous("Lesion volume [ml]", trans = "log10", breaks = c(0.1, 1, 10, 100, 1000), labels = rep(expression(10^(-01)),5)) +
scale_y_continuous("Somatosensory deficit [193-RASP]") +
scale_shape_manual(name = "Phase", values = c(13, 1, 2, 4)) +
scale_color_manual(name = "Phase", values = c(swatch()[2],'darkred'), labels = c("Acute", "Chronic")) +
guides(color = FALSE, group=FALSE, shape=FALSE) + # time = guide_legend(title = "Phase", )
theme(
legend.position = c(.2, .8),
panel.grid.minor = element_blank()
)
p.vol
p.vol <- d.plot.vol %>%
unnest(c(pris, data), names_repair = "unique") %>%
filter(mod == 'RASP' & time == 'T1') %>%
bind_cols(gdata::read.xls('./../../clinical/MRdate_lesionsites.xlsx', sheet = 1) %>%
as_tibble() %>%
dplyr::select(Probanden.ID, `diff.mri.onset.`, `X.4`) %>%
dplyr::filter(!is.na(Probanden.ID))
) %>%
mutate(compartment = as.character(X.4)
, compartment = case_when(stringr::str_starts(compartment, 'comb') ~ 'combined'
, compartment %in% c('brain stem', 'cerebellar') ~ 'hind brain'
, TRUE ~ compartment)) %>%
ggplot(aes(x = lesionvolume/1000, y = value, group = time)) +
geom_point(aes(shape = compartment, color = if_else(`subID...3` %in% highInf, 'red', 'blue')), alpha = .5, size = 1) +
geom_line(aes(y = curve.vol), d.curve.vol %>% filter(mod == 'RASP' & time == 'T1')) +
geom_errorbar(aes(ymin = lwr, ymax = upr), alpha = .25) +
geom_point(aes(y = pest), fill = "white", shape = 21, size = .25) +
theme_minimal() +
#facet_grid(~mod) +
scale_x_continuous("Lesion volume [ml]", trans = "log10", breaks = c(0.1, 1, 10, 100, 1000), labels = rep(expression(10^(--01)),5)) +
scale_y_continuous("Somatosensory deficit [193-RASP]") +
scale_shape_manual(name = "Phase", values = c(13, 1, 2, 4)) +
scale_color_manual(name = "Phase", values = c(swatch()[2],'darkred'), labels = c("Acute", "Chronic")) +
guides(color = FALSE, group=FALSE, shape=FALSE) + # time = guide_legend(title = "Phase", )
theme(
legend.position = c(.2, .8),
panel.grid.minor = element_blank()
)
p.vol
p.vol <- d.plot.vol %>%
unnest(c(pris, data), names_repair = "unique") %>%
filter(mod == 'RASP' & time == 'T1') %>%
bind_cols(gdata::read.xls('./../../clinical/MRdate_lesionsites.xlsx', sheet = 1) %>%
as_tibble() %>%
dplyr::select(Probanden.ID, `diff.mri.onset.`, `X.4`) %>%
dplyr::filter(!is.na(Probanden.ID))
) %>%
mutate(compartment = as.character(X.4)
, compartment = case_when(stringr::str_starts(compartment, 'comb') ~ 'combined'
, compartment %in% c('brain stem', 'cerebellar') ~ 'hind brain'
, TRUE ~ compartment)) %>%
ggplot(aes(x = lesionvolume/1000, y = value, group = time)) +
geom_point(aes(shape = compartment, color = if_else(`subID...3` %in% highInf, 'red', 'blue')), alpha = .5, size = 1) +
geom_line(aes(y = curve.vol), d.curve.vol %>% filter(mod == 'RASP' & time == 'T1')) +
geom_errorbar(aes(ymin = lwr, ymax = upr), alpha = .25) +
geom_point(aes(y = pest), fill = "white", shape = 21, size = .25) +
theme_minimal() +
#facet_grid(~mod) +
scale_x_continuous("Lesion volume [ml]", trans = "log10", breaks = c(0.1, 1, 10, 100, 1000), labels = rep(expression(10^(-01)),5)) +
scale_y_continuous("Somatosensory deficit [193-RASP]") +
scale_shape_manual(name = "Phase", values = c(13, 1, 2, 4)) +
scale_color_manual(name = "Phase", values = c(swatch()[2],'darkred'), labels = c("Acute", "Chronic")) +
guides(color = FALSE, group=FALSE, shape=FALSE) + # time = guide_legend(title = "Phase", )
theme(
legend.position = c(.2, .8),
panel.grid.minor = element_blank()
)
p.vol
p.vol <- d.plot.vol %>%
unnest(c(pris, data), names_repair = "unique") %>%
filter(mod == 'RASP' & time == 'T1') %>%
bind_cols(gdata::read.xls('./../../clinical/MRdate_lesionsites.xlsx', sheet = 1) %>%
as_tibble() %>%
dplyr::select(Probanden.ID, `diff.mri.onset.`, `X.4`) %>%
dplyr::filter(!is.na(Probanden.ID))
) %>%
mutate(compartment = as.character(X.4)
, compartment = case_when(stringr::str_starts(compartment, 'comb') ~ 'combined'
, compartment %in% c('brain stem', 'cerebellar') ~ 'hind brain'
, TRUE ~ compartment)) %>%
ggplot(aes(x = lesionvolume/1000, y = value, group = time)) +
geom_point(aes(shape = compartment, color = if_else(`subID...3` %in% highInf, 'red', 'blue')), alpha = .5, size = 1) +
geom_line(aes(y = curve.vol), d.curve.vol %>% filter(mod == 'RASP' & time == 'T1')) +
geom_errorbar(aes(ymin = lwr, ymax = upr), alpha = .25) +
geom_point(aes(y = pest), fill = "white", shape = 21, size = .25) +
theme_minimal() +
#facet_grid(~mod) +
scale_x_continuous("Lesion volume [ml]", trans = "log10", breaks = c(0.1, 1, 10, 100, 1000), labels = rep(expression(10^+01),5)) +
scale_y_continuous("Somatosensory deficit [193-RASP]") +
scale_shape_manual(name = "Phase", values = c(13, 1, 2, 4)) +
scale_color_manual(name = "Phase", values = c(swatch()[2],'darkred'), labels = c("Acute", "Chronic")) +
guides(color = FALSE, group=FALSE, shape=FALSE) + # time = guide_legend(title = "Phase", )
theme(
legend.position = c(.2, .8),
panel.grid.minor = element_blank()
)
p.vol
p.vol <- d.plot.vol %>%
unnest(c(pris, data), names_repair = "unique") %>%
filter(mod == 'RASP' & time == 'T1') %>%
bind_cols(gdata::read.xls('./../../clinical/MRdate_lesionsites.xlsx', sheet = 1) %>%
as_tibble() %>%
dplyr::select(Probanden.ID, `diff.mri.onset.`, `X.4`) %>%
dplyr::filter(!is.na(Probanden.ID))
) %>%
mutate(compartment = as.character(X.4)
, compartment = case_when(stringr::str_starts(compartment, 'comb') ~ 'combined'
, compartment %in% c('brain stem', 'cerebellar') ~ 'hind brain'
, TRUE ~ compartment)) %>%
ggplot(aes(x = lesionvolume/1000, y = value, group = time)) +
geom_point(aes(shape = compartment, color = if_else(`subID...3` %in% highInf, 'red', 'blue')), alpha = .5, size = 1) +
geom_line(aes(y = curve.vol), d.curve.vol %>% filter(mod == 'RASP' & time == 'T1')) +
geom_errorbar(aes(ymin = lwr, ymax = upr), alpha = .25) +
geom_point(aes(y = pest), fill = "white", shape = 21, size = .25) +
theme_minimal() +
#facet_grid(~mod) +
scale_x_continuous("Lesion volume [ml]", trans = "log10", breaks = c(0.1, 1, 10, 100, 1000), labels = rep(expression(10^-01),5)) +
scale_y_continuous("Somatosensory deficit [193-RASP]") +
scale_shape_manual(name = "Phase", values = c(13, 1, 2, 4)) +
scale_color_manual(name = "Phase", values = c(swatch()[2],'darkred'), labels = c("Acute", "Chronic")) +
guides(color = FALSE, group=FALSE, shape=FALSE) + # time = guide_legend(title = "Phase", )
theme(
legend.position = c(.2, .8),
panel.grid.minor = element_blank()
)
p.vol
p.vol <- d.plot.vol %>%
unnest(c(pris, data), names_repair = "unique") %>%
filter(mod == 'RASP' & time == 'T1') %>%
bind_cols(gdata::read.xls('./../../clinical/MRdate_lesionsites.xlsx', sheet = 1) %>%
as_tibble() %>%
dplyr::select(Probanden.ID, `diff.mri.onset.`, `X.4`) %>%
dplyr::filter(!is.na(Probanden.ID))
) %>%
mutate(compartment = as.character(X.4)
, compartment = case_when(stringr::str_starts(compartment, 'comb') ~ 'combined'
, compartment %in% c('brain stem', 'cerebellar') ~ 'hind brain'
, TRUE ~ compartment)) %>%
ggplot(aes(x = lesionvolume/1000, y = value, group = time)) +
geom_point(aes(shape = compartment, color = if_else(`subID...3` %in% highInf, 'red', 'blue')), alpha = .5, size = 1) +
geom_line(aes(y = curve.vol), d.curve.vol %>% filter(mod == 'RASP' & time == 'T1')) +
geom_errorbar(aes(ymin = lwr, ymax = upr), alpha = .25) +
geom_point(aes(y = pest), fill = "white", shape = 21, size = .25) +
theme_minimal() +
#facet_grid(~mod) +
scale_x_continuous("Lesion volume [ml]", trans = "log10", breaks = c(0.1, 1, 10, 100, 1000), labels = rep(expression(10^{-01}),5)) +
scale_y_continuous("Somatosensory deficit [193-RASP]") +
scale_shape_manual(name = "Phase", values = c(13, 1, 2, 4)) +
scale_color_manual(name = "Phase", values = c(swatch()[2],'darkred'), labels = c("Acute", "Chronic")) +
guides(color = FALSE, group=FALSE, shape=FALSE) + # time = guide_legend(title = "Phase", )
theme(
legend.position = c(.2, .8),
panel.grid.minor = element_blank()
)
p.vol
p.vol <- d.plot.vol %>%
unnest(c(pris, data), names_repair = "unique") %>%
filter(mod == 'RASP' & time == 'T1') %>%
bind_cols(gdata::read.xls('./../../clinical/MRdate_lesionsites.xlsx', sheet = 1) %>%
as_tibble() %>%
dplyr::select(Probanden.ID, `diff.mri.onset.`, `X.4`) %>%
dplyr::filter(!is.na(Probanden.ID))
) %>%
mutate(compartment = as.character(X.4)
, compartment = case_when(stringr::str_starts(compartment, 'comb') ~ 'combined'
, compartment %in% c('brain stem', 'cerebellar') ~ 'hind brain'
, TRUE ~ compartment)) %>%
ggplot(aes(x = lesionvolume/1000, y = value, group = time)) +
geom_point(aes(shape = compartment, color = if_else(`subID...3` %in% highInf, 'red', 'blue')), alpha = .5, size = 1) +
geom_line(aes(y = curve.vol), d.curve.vol %>% filter(mod == 'RASP' & time == 'T1')) +
geom_errorbar(aes(ymin = lwr, ymax = upr), alpha = .25) +
geom_point(aes(y = pest), fill = "white", shape = 21, size = .25) +
theme_minimal() +
#facet_grid(~mod) +
scale_x_continuous("Lesion volume [ml]", trans = "log10", breaks = c(0.1, 1, 10, 100, 1000), labels = rep(expression(10^{"-"01}),5)) +
p.vol <- d.plot.vol %>%
unnest(c(pris, data), names_repair = "unique") %>%
filter(mod == 'RASP' & time == 'T1') %>%
bind_cols(gdata::read.xls('./../../clinical/MRdate_lesionsites.xlsx', sheet = 1) %>%
as_tibble() %>%
dplyr::select(Probanden.ID, `diff.mri.onset.`, `X.4`) %>%
dplyr::filter(!is.na(Probanden.ID))
) %>%
mutate(compartment = as.character(X.4)
, compartment = case_when(stringr::str_starts(compartment, 'comb') ~ 'combined'
, compartment %in% c('brain stem', 'cerebellar') ~ 'hind brain'
, TRUE ~ compartment)) %>%
ggplot(aes(x = lesionvolume/1000, y = value, group = time)) +
geom_point(aes(shape = compartment, color = if_else(`subID...3` %in% highInf, 'red', 'blue')), alpha = .5, size = 1) +
geom_line(aes(y = curve.vol), d.curve.vol %>% filter(mod == 'RASP' & time == 'T1')) +
geom_errorbar(aes(ymin = lwr, ymax = upr), alpha = .25) +
geom_point(aes(y = pest), fill = "white", shape = 21, size = .25) +
theme_minimal() +
#facet_grid(~mod) +
scale_x_continuous("Lesion volume [ml]", trans = "log10", breaks = c(0.1, 1, 10, 100, 1000), labels = rep(expression(10^{~"-"~01}),5)) +
scale_y_continuous("Somatosensory deficit [193-RASP]") +
scale_shape_manual(name = "Phase", values = c(13, 1, 2, 4)) +
scale_color_manual(name = "Phase", values = c(swatch()[2],'darkred'), labels = c("Acute", "Chronic")) +
guides(color = FALSE, group=FALSE, shape=FALSE) + # time = guide_legend(title = "Phase", )
theme(
legend.position = c(.2, .8),
panel.grid.minor = element_blank()
)
p.vol
scientific_10
scientific_10(.01)
gsub('-','+\,scientific_10(.01))
gsub('-','+',scientific_10(.01))
parse(gsub('-','+',scientific_10(.01)))
parse(text = gsub('-','+',scientific_10(.01)))
gsub("e", " %*% 10^", scales::scientific_format()(.01))
gsub('-','~"-"~',gsub("e", " %*% 10^", scales::scientific_format()(.01)))
parse(text=gsub('-','~"-"~',gsub("e", " %*% 10^", scales::scientific_format()(.01))))
p.vol <- d.plot.vol %>%
unnest(c(pris, data), names_repair = "unique") %>%
filter(mod == 'RASP' & time == 'T1') %>%
bind_cols(gdata::read.xls('./../../clinical/MRdate_lesionsites.xlsx', sheet = 1) %>%
as_tibble() %>%
dplyr::select(Probanden.ID, `diff.mri.onset.`, `X.4`) %>%
dplyr::filter(!is.na(Probanden.ID))
) %>%
mutate(compartment = as.character(X.4)
, compartment = case_when(stringr::str_starts(compartment, 'comb') ~ 'combined'
, compartment %in% c('brain stem', 'cerebellar') ~ 'hind brain'
, TRUE ~ compartment)) %>%
ggplot(aes(x = lesionvolume/1000, y = value, group = time)) +
geom_point(aes(shape = compartment, color = if_else(`subID...3` %in% highInf, 'red', 'blue')), alpha = .5, size = 1) +
geom_line(aes(y = curve.vol), d.curve.vol %>% filter(mod == 'RASP' & time == 'T1')) +
geom_errorbar(aes(ymin = lwr, ymax = upr), alpha = .25) +
geom_point(aes(y = pest), fill = "white", shape = 21, size = .25) +
theme_minimal() +
#facet_grid(~mod) +
scale_x_continuous("Lesion volume [ml]", trans = "log10", breaks = c(0.1, 1, 10, 100, 1000), labels = rep(expression(10^~"-"~02),5)) +
scale_y_continuous("Somatosensory deficit [193-RASP]") +
scale_shape_manual(name = "Phase", values = c(13, 1, 2, 4)) +
scale_color_manual(name = "Phase", values = c(swatch()[2],'darkred'), labels = c("Acute", "Chronic")) +
guides(color = FALSE, group=FALSE, shape=FALSE) + # time = guide_legend(title = "Phase", )
theme(
legend.position = c(.2, .8),
panel.grid.minor = element_blank()
)
p.vol
p.vol <- d.plot.vol %>%
unnest(c(pris, data), names_repair = "unique") %>%
filter(mod == 'RASP' & time == 'T1') %>%
bind_cols(gdata::read.xls('./../../clinical/MRdate_lesionsites.xlsx', sheet = 1) %>%
as_tibble() %>%
dplyr::select(Probanden.ID, `diff.mri.onset.`, `X.4`) %>%
dplyr::filter(!is.na(Probanden.ID))
) %>%
mutate(compartment = as.character(X.4)
, compartment = case_when(stringr::str_starts(compartment, 'comb') ~ 'combined'
, compartment %in% c('brain stem', 'cerebellar') ~ 'hind brain'
, TRUE ~ compartment)) %>%
ggplot(aes(x = lesionvolume/1000, y = value, group = time)) +
geom_point(aes(shape = compartment, color = if_else(`subID...3` %in% highInf, 'red', 'blue')), alpha = .5, size = 1) +
geom_line(aes(y = curve.vol), d.curve.vol %>% filter(mod == 'RASP' & time == 'T1')) +
geom_errorbar(aes(ymin = lwr, ymax = upr), alpha = .25) +
geom_point(aes(y = pest), fill = "white", shape = 21, size = .25) +
theme_minimal() +
#facet_grid(~mod) +
scale_x_continuous("Lesion volume [ml]", trans = "log10", breaks = c(0.1, 1, 10, 100, 1000), labels = rep(expression(10^{~"-"~02}),5)) +
scale_y_continuous("Somatosensory deficit [193-RASP]") +
scale_shape_manual(name = "Phase", values = c(13, 1, 2, 4)) +
scale_color_manual(name = "Phase", values = c(swatch()[2],'darkred'), labels = c("Acute", "Chronic")) +
guides(color = FALSE, group=FALSE, shape=FALSE) + # time = guide_legend(title = "Phase", )
theme(
legend.position = c(.2, .8),
panel.grid.minor = element_blank()
)
p.vol
scientific_10(c(.1,1))
lapply(c(0.1, 1, 10, 100, 1000), scientific_10)
sapply(c(0.1, 1, 10, 100, 1000), scientific_10)
expression(10^{~"-"~02})
p.vol <- d.plot.vol %>%
unnest(c(pris, data), names_repair = "unique") %>%
filter(mod == 'RASP' & time == 'T1') %>%
bind_cols(gdata::read.xls('./../../clinical/MRdate_lesionsites.xlsx', sheet = 1) %>%
as_tibble() %>%
dplyr::select(Probanden.ID, `diff.mri.onset.`, `X.4`) %>%
dplyr::filter(!is.na(Probanden.ID))
) %>%
mutate(compartment = as.character(X.4)
, compartment = case_when(stringr::str_starts(compartment, 'comb') ~ 'combined'
, compartment %in% c('brain stem', 'cerebellar') ~ 'hind brain'
, TRUE ~ compartment)) %>%
ggplot(aes(x = lesionvolume/1000, y = value, group = time)) +
geom_point(aes(shape = compartment, color = if_else(`subID...3` %in% highInf, 'red', 'blue')), alpha = .5, size = 1) +
geom_line(aes(y = curve.vol), d.curve.vol %>% filter(mod == 'RASP' & time == 'T1')) +
geom_errorbar(aes(ymin = lwr, ymax = upr), alpha = .25) +
geom_point(aes(y = pest), fill = "white", shape = 21, size = .25) +
theme_minimal() +
#facet_grid(~mod) +
scale_x_continuous("Lesion volume [ml]", trans = "log10", breaks = c(0.1, 1, 10, 100, 1000), labels = lapply(c(0.1, 1, 10, 100, 1000), scientific_10)) +
scale_y_continuous("Somatosensory deficit [193-RASP]") +
scale_shape_manual(name = "Phase", values = c(13, 1, 2, 4)) +
scale_color_manual(name = "Phase", values = c(swatch()[2],'darkred'), labels = c("Acute", "Chronic")) +
guides(color = FALSE, group=FALSE, shape=FALSE) + # time = guide_legend(title = "Phase", )
theme(
legend.position = c(.2, .8),
panel.grid.minor = element_blank()
)
p.vol
p.vol <- d.plot.vol %>%
unnest(c(pris, data), names_repair = "unique") %>%
filter(mod == 'RASP' & time == 'T1') %>%
bind_cols(gdata::read.xls('./../../clinical/MRdate_lesionsites.xlsx', sheet = 1) %>%
as_tibble() %>%
dplyr::select(Probanden.ID, `diff.mri.onset.`, `X.4`) %>%
dplyr::filter(!is.na(Probanden.ID))
) %>%
mutate(compartment = as.character(X.4)
, compartment = case_when(stringr::str_starts(compartment, 'comb') ~ 'combined'
, compartment %in% c('brain stem', 'cerebellar') ~ 'hind brain'
, TRUE ~ compartment)) %>%
ggplot(aes(x = lesionvolume/1000, y = value, group = time)) +
geom_point(aes(shape = compartment, color = if_else(`subID...3` %in% highInf, 'red', 'blue')), alpha = .5, size = 1) +
geom_line(aes(y = curve.vol), d.curve.vol %>% filter(mod == 'RASP' & time == 'T1')) +
geom_errorbar(aes(ymin = lwr, ymax = upr), alpha = .25) +
geom_point(aes(y = pest), fill = "white", shape = 21, size = .25) +
theme_minimal() +
#facet_grid(~mod) +
scale_x_continuous("Lesion volume [ml]", trans = "log10", breaks = c(0.1, 1, 10, 100, 1000), labels = sapply(c(0.1, 1, 10, 100, 1000), scientific_10)) +
scale_y_continuous("Somatosensory deficit [193-RASP]") +
scale_shape_manual(name = "Phase", values = c(13, 1, 2, 4)) +
scale_color_manual(name = "Phase", values = c(swatch()[2],'darkred'), labels = c("Acute", "Chronic")) +
guides(color = FALSE, group=FALSE, shape=FALSE) + # time = guide_legend(title = "Phase", )
theme(
legend.position = c(.2, .8),
panel.grid.minor = element_blank()
)
p.vol
p.vol <- d.plot.vol %>%
unnest(c(pris, data), names_repair = "unique") %>%
filter(mod == 'RASP' & time == 'T1') %>%
bind_cols(gdata::read.xls('./../../clinical/MRdate_lesionsites.xlsx', sheet = 1) %>%
as_tibble() %>%
dplyr::select(Probanden.ID, `diff.mri.onset.`, `X.4`) %>%
dplyr::filter(!is.na(Probanden.ID))
) %>%
mutate(compartment = as.character(X.4)
, compartment = case_when(stringr::str_starts(compartment, 'comb') ~ 'combined'
, compartment %in% c('brain stem', 'cerebellar') ~ 'hind brain'
, TRUE ~ compartment)) %>%
ggplot(aes(x = lesionvolume/1000, y = value, group = time)) +
geom_point(aes(shape = compartment, color = if_else(`subID...3` %in% highInf, 'red', 'blue')), alpha = .5, size = 1) +
geom_line(aes(y = curve.vol), d.curve.vol %>% filter(mod == 'RASP' & time == 'T1')) +
geom_errorbar(aes(ymin = lwr, ymax = upr), alpha = .25) +
geom_point(aes(y = pest), fill = "white", shape = 21, size = .25) +
theme_minimal() +
#facet_grid(~mod) +
scale_x_continuous("Lesion volume [ml]", trans = "log10", breaks = c(0.1, 1, 10, 100, 1000), labels = scientific_10(c(0.1, 1, 10, 100, 1000))) +
scale_y_continuous("Somatosensory deficit [193-RASP]") +
scale_shape_manual(name = "Phase", values = c(13, 1, 2, 4)) +
scale_color_manual(name = "Phase", values = c(swatch()[2],'darkred'), labels = c("Acute", "Chronic")) +
guides(color = FALSE, group=FALSE, shape=FALSE) + # time = guide_legend(title = "Phase", )
theme(
legend.position = c(.2, .8),
panel.grid.minor = element_blank()
)
p.vol
p.vol <- d.plot.vol %>%
unnest(c(pris, data), names_repair = "unique") %>%
filter(mod == 'RASP' & time == 'T1') %>%
bind_cols(gdata::read.xls('./../../clinical/MRdate_lesionsites.xlsx', sheet = 1) %>%
as_tibble() %>%
dplyr::select(Probanden.ID, `diff.mri.onset.`, `X.4`) %>%
dplyr::filter(!is.na(Probanden.ID))
) %>%
mutate(compartment = as.character(X.4)
, compartment = case_when(stringr::str_starts(compartment, 'comb') ~ 'combined'
, compartment %in% c('brain stem', 'cerebellar') ~ 'hind brain'
, TRUE ~ compartment)) %>%
ggplot(aes(x = lesionvolume/1000, y = value, group = time)) +
geom_point(aes(shape = compartment, color = if_else(`subID...3` %in% highInf, 'red', 'blue')), alpha = .5, size = 1) +
geom_line(aes(y = curve.vol), d.curve.vol %>% filter(mod == 'RASP' & time == 'T1')) +
geom_errorbar(aes(ymin = lwr, ymax = upr), alpha = .25) +
geom_point(aes(y = pest), fill = "white", shape = 21, size = .25) +
theme_minimal() +
#facet_grid(~mod) +
scale_x_continuous("Lesion volume [ml]", trans = "log10", breaks = c(0.1, 1, 10, 100, 1000), labels = c(expression(10^{~"-"~02}), scientific_10(c(1, 10, 100, 1000)))) +
scale_y_continuous("Somatosensory deficit [193-RASP]") +
scale_shape_manual(name = "Phase", values = c(13, 1, 2, 4)) +
scale_color_manual(name = "Phase", values = c(swatch()[2],'darkred'), labels = c("Acute", "Chronic")) +
guides(color = FALSE, group=FALSE, shape=FALSE) + # time = guide_legend(title = "Phase", )
theme(
legend.position = c(.2, .8),
panel.grid.minor = element_blank()
)
p.vol
p.vol <- d.plot.vol %>%
unnest(c(pris, data), names_repair = "unique") %>%
filter(mod == 'RASP' & time == 'T1') %>%
bind_cols(gdata::read.xls('./../../clinical/MRdate_lesionsites.xlsx', sheet = 1) %>%
as_tibble() %>%
dplyr::select(Probanden.ID, `diff.mri.onset.`, `X.4`) %>%
dplyr::filter(!is.na(Probanden.ID))
) %>%
mutate(compartment = as.character(X.4)
, compartment = case_when(stringr::str_starts(compartment, 'comb') ~ 'combined'
, compartment %in% c('brain stem', 'cerebellar') ~ 'hind brain'
, TRUE ~ compartment)) %>%
ggplot(aes(x = lesionvolume/1000, y = value, group = time)) +
geom_point(aes(shape = compartment, color = if_else(`subID...3` %in% highInf, 'red', 'blue')), alpha = .5, size = 1) +
geom_line(aes(y = curve.vol), d.curve.vol %>% filter(mod == 'RASP' & time == 'T1')) +
geom_errorbar(aes(ymin = lwr, ymax = upr), alpha = .25) +
geom_point(aes(y = pest), fill = "white", shape = 21, size = .25) +
theme_minimal() +
#facet_grid(~mod) +
scale_x_continuous("Lesion volume [ml]", trans = "log10", breaks = c(0.1, 1, 10, 100, 1000), labels = c(expression(10^{~"-"~01}), scientific_10(c(1, 10, 100, 1000)))) +
scale_y_continuous("Somatosensory deficit [193-RASP]") +
scale_shape_manual(name = "Phase", values = c(13, 1, 2, 4)) +
scale_color_manual(name = "Phase", values = c(swatch()[2],'darkred'), labels = c("Acute", "Chronic")) +
guides(color = FALSE, group=FALSE, shape=FALSE) + # time = guide_legend(title = "Phase", )
theme(
legend.position = c(.2, .8),
panel.grid.minor = element_blank()
)
p.vol
